@model Foillan.Models.Geography.Location

@Html.HiddenFor(l => l.Latitude)
@Html.HiddenFor(l => l.Longitude)

<style>
    #map-canvas {
        height: 40em;
        width: 100%;
    }
</style>

<script type="text/javascript"
        src="https://maps.googleapis.com/maps/api/js?sensor=TRUE">
</script>
<script type="text/javascript">
    var map;
    var marker;
    var $latitude = document.getElementById('Location_Latitude');
    var $longitude = document.getElementById('Location_Longitude');

    function initialize() {
        var mapOptions = {
            center: new google.maps.LatLng(54.229405, -4.529114),
            zoom: 10
        };

        map = new google.maps.Map(document.getElementById("map-canvas"),
            mapOptions);

        google.maps.event.addListener(map, 'click', function (event) {
            placeMarker(event.latLng);
            $latitude.value = event.latLng.lat();
            $longitude.value = event.latLng.lng();
        });

    }

    function placeMarker(location) {
        if (!marker) {
            marker = new google.maps.Marker({
                position: location,
                map: map
            });
        }
        else { marker.setPosition(location); }
    }

    google.maps.event.addDomListener(window, 'load', initialize);
</script>
<div id="map-canvas" />